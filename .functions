# -*- mode: sh -*-
function syu {
    sudo pacman -Syu && xmonad --recompile
}

function cwd2paths {
    export PYTHONPATH=$PYTHONPATH:$(pwd)
}

function collapse_pwd {
    echo $(pwd | sed -e "s,^$HOME,~,")
}

function kill-ports-of-process {
    lsof -n -P -i4 -a -itcp -a -i :$2 -p $1
}

function archnews {
    w3m https://www.archlinux.org/news/ | awk 'NR>17 && NR<30'
}

function clean-namespace-of() {
  kubectl delete pods $(kubectl get pods -n $1 | grep $2 | cut -f1 -d' ' | paste -sd' ' -) -n $1
}

function clean-evicted() {
  clean-namespace-of $1 Evicted
}

function clean-pending() {
  clean-namespace-of $1 Pending
}

function clean-crashing() {
  clean-namespace-of $1 CrashLoopBackOff
  clean-namespace-of $1 Init:CrashLoopBackOff
  clean-namespace-of $1 Init:Error
}

function weather() {
    curl http://v2.wttr.in/KRK
}

function npm-install() {
    nodenv each -p=10 npm i -g $1 && nodenv rehash
}

aur-install() {
    cd /tmp/ && git clone https://aur.archlinux.org/$1.git && cd $1 && makepkg -sfi
}

calc-cidr() {
    echo $(((2 ** (32 - $1)) - 2))
}

function google-dns() {
    curl --silent "https://dns.google/resolve?name=${1}" | jq '.Answer'
}

scale-down-namespace() {
     kubectl scale deploy -n "${1}"  --replicas=0 --all
}

scale-up-namespace() {
    kubectl scale deploy -n "${1}"  --replicas=1 --all
}

get-ssl-for-site() {
    echo | openssl s_client -servername "${1}".6river.org -connect "${1}".6river.org:443 |\
        sed -ne '/-BEGIN CERTIFICATE-/,/-END CERTIFICATE-/p'
}
